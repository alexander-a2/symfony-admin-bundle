{% set recordsTotal = datasheet.totalRecordsFiltered %}
{% set recordsPerPage = datasheet.filter('pgn').parameter('recordsPerPage') %}
{% set pagesTotal = (recordsTotal / recordsPerPage)|round(0, 'ceil') %}
{% set currentPage = datasheet.filter('pgn').parameter('currentPage') %}

<div data-datasheet="{{ datasheet.name }}" data-datasheet-filters-key="{{ datasheet.queryKey('datasheet_filters') }}">
    <div style="width:100%;overflow-x: auto;">
        <form action="?" method="GET" data-datasheet-form="{{ datasheet.name }}">
            <table class="table table-hover table-bordered table-hover text-secondary table-responsive">
                <thead class="bg-secondary text-white">
                <th class="border-bottom" style="width:30px;text-align:center;">
                    <input type="checkbox">
                </th>
                {% for column in datasheet.columns %}
                    <th class="border-bottom"
                        style="{{ column.styles }};white-space: nowrap;overflow: hidden;text-overflow: ellipsis;"
                        data-datasheet-column-title="{{ column.name }}"
                    >
                        {{ column.title }}
                        {% if (datasheet.filter('sort').parameters['by'] ?? null) == column.name %}
                            {{ datasheet.filter('sort').parameters['direction'] == 'asc' ? '▲' : '▼' }}
                        {% endif %}
                    </th>
                {% endfor %}
                </thead>

                {% for record in datasheet.data %}
                    <tr>
                        <td style="width:30px;text-align:center;">
                            <input type="checkbox">
                        </td>
                        {% for column in datasheet.columns %}
                            <td>
                                <div style="{{ column.styles }};white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">
                                    {{ column.getContent(record)|raw }}
                                </div>
                            </td>
                        {% endfor %}
                    </tr>
                {% endfor %}
            </table>

            <div>
                <nav>
                    <div class="text-muted m-2">
                        {{ 'datasheet.filters.pagination.records_total'|trans }}: {{ recordsTotal }},
                        {{ 'datasheet.filters.pagination.records_per_page'|trans }}: {{ recordsPerPage }},
                        {{ 'datasheet.filters.pagination.pages_total'|trans }}: {{ pagesTotal }},
                        {{ 'datasheet.filters.pagination.current_page'|trans }}: {{ currentPage }}
                    </div>
                    <ul class="pagination m-2"
                        data-datasheet-pagination="{{ datasheet.name }}"
                        data-datasheet-pagination-records-total="{{ recordsTotal }}"
                        data-datasheet-pagination-records-per-page="{{ recordsPerPage }}"
                        data-datasheet-pagination-pages-total="{{ pagesTotal }}"
                        data-datasheet-pagination-current-page="{{ currentPage }}"
                    >
                    </ul>
                </nav>
            </div>
            {% for parameterName, parameterValue in datasheet.queryStringParameters %}
                <input type="{{ datasheet.debug ? 'text' : 'hidden' }}" name="{{ parameterName }}"
                       value="{{ parameterValue }}">
            {% endfor %}

            {% include '@Admin/datasheet/datasheet_filters.html.twig' %}
            {{ datasheet.debug ? '<input type="submit">' : '' }}
            {% include '@Admin/datasheet/javascript.html.twig' %}
        </form>
    </div>
    {{ datasheet.debug ? dump(datasheet) : '' }}
</div>
